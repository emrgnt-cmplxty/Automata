<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Your Own Embeddings &mdash; Automata  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/dark_mode_js/default_dark.js"></script>
        <script src="_static/dark_mode_js/theme_switcher.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Agent Guide" href="agent_guide.html" />
    <link rel="prev" title="Frequently Asked Questions" href="faq.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Automata
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup_guide.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating Your Own Embeddings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configure-the-pyright-scip-repository">Configure the pyright-scip repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-the-code-embeddings">Update the Code Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-and-embed-the-docs">Build and Embed the Docs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="agent_guide.html">Agent Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Config Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="core/index.html">Core Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/index.html">Test Classes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Automata</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Creating Your Own Embeddings</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/embedding_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-your-own-embeddings">
<h1>Creating Your Own Embeddings<a class="headerlink" href="#creating-your-own-embeddings" title="Permalink to this headline"></a></h1>
<p>Automata’s powerful architecture allows you to create your own code and documentation embeddings. This guide provides you with step-by-step instructions to accomplish that.</p>
<section id="configure-the-pyright-scip-repository">
<h2>Configure the pyright-scip repository<a class="headerlink" href="#configure-the-pyright-scip-repository" title="Permalink to this headline"></a></h2>
<p>Before you start, make sure that you have properly configured the pyright-scip repository. The below steps are needed to create the index using pyright-scip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>local_env/bin/activate
<span class="c1"># Ensure that submodules have been initialized</span>
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
<span class="c1"># Install the indexing software</span>
<span class="nb">cd</span><span class="w"> </span>scip-python
npm<span class="w"> </span>install
<span class="nb">cd</span><span class="w"> </span>packages/pyright-scip
npm<span class="w"> </span>run<span class="w"> </span>build
<span class="c1"># Return to working dir</span>
<span class="nb">cd</span><span class="w"> </span>../../../
</pre></div>
</div>
<p>Next, we will create the index. This will be used to generate the code embeddings.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the index and move it into the default location</span>
node<span class="w"> </span>scip-python/packages/pyright-scip/index<span class="w"> </span>index<span class="w">  </span>--project-name<span class="w"> </span>automata<span class="w"> </span>--output<span class="w"> </span>index_from_fork.scip<span class="w">  </span>--target-only<span class="w"> </span>automata
mv<span class="w"> </span>index_from_fork.scip<span class="w"> </span>automata/config/symbol/index.scip
</pre></div>
</div>
</section>
<section id="update-the-code-embeddings">
<h2>Update the Code Embeddings<a class="headerlink" href="#update-the-code-embeddings" title="Permalink to this headline"></a></h2>
<p>Next, we will update the code embeddings. This will use the index we created to generate embeddings from the codebase. The code embeddings will later be used in various downstream tasks such as code similarity search and autocompletion.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update the code embeddings</span>
automata<span class="w"> </span>run-code-embedding
</pre></div>
</div>
<p>Under the hood, <cite>run-code-embedding</cite> runs the main function of the script shown below. This function loads the configured symbol graph and code embedding handler. For each symbol in the graph, it calls <cite>process_embedding</cite> on the embedding handler to calculate the symbol’s embedding.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="n">filtered_symbols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">get_rankable_symbols</span><span class="p">(</span><span class="n">all_defined_symbols</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">dotpath</span><span class="p">)</span>
<span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">filtered_symbols</span><span class="p">):</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">symbol_code_embedding_handler</span><span class="o">.</span><span class="n">process_embedding</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
      <span class="n">symbol_code_embedding_handler</span><span class="o">.</span><span class="n">embedding_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
   <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to update embedding for </span><span class="si">{</span><span class="n">symbol</span><span class="o">.</span><span class="n">dotpath</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="build-and-embed-the-docs">
<h2>Build and Embed the Docs<a class="headerlink" href="#build-and-embed-the-docs" title="Permalink to this headline"></a></h2>
<p>Finally, we will build and embed the documentation. This is useful for tasks like searching the documentation for relevant information.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build and embed the L2 docs</span>
automata<span class="w"> </span>run-doc-embedding<span class="w"> </span>--embedding-level<span class="o">=</span><span class="m">2</span>
<span class="c1"># Build and embed the L3 docs</span>
automata<span class="w"> </span>run-doc-embedding<span class="w">  </span>--embedding-level<span class="o">=</span><span class="m">3</span>
</pre></div>
</div>
<p>Now you have successfully created your own code and documentation embeddings.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="faq.html" class="btn btn-neutral float-left" title="Frequently Asked Questions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="agent_guide.html" class="btn btn-neutral float-right" title="Agent Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, emrgnt-cmplxty.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>